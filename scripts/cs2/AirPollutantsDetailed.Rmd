<!--
|  (C) 2006-2024 Potsdam Institute for Climate Impact Research (PIK)
|  authors, and contributors see CITATION.cff file. This file is part
|  of REMIND and licensed under AGPL-3.0-or-later. Under Section 7 of
|  AGPL-3.0, you are granted additional permissions described in the
|  REMIND License Exception, version 1.0 (see LICENSE file).
|  Contact: remind@pik-potsdam.de
-->
# Air Pollutants detailed

```{r, echo = FALSE, results = 'hide'}
# Adds a new variable as the sum of a list of variables
addSumVariables <- function(
  fdata, sumvars, outvarname, outunit = NULL, convmult = 1, convoffset = 0, only.new = FALSE
  ) {
  if (is.null(outunit)) {
    outunit <- fdata %>%
      filter(variable == sumvars[1]) %>%
      slice(1) %>%
      select(unit) %>% unlist %>% as.character
  }

  newdata <- fdata %>%
    filter(variable %in% sumvars) %>%
    select(-varplus) %>%
    distinct %>%
    pivot_wider(names_from = variable, values_from = value) %>%
    mutate(value = rowSums(across(sumvars))) %>%
    select(-c(sumvars)) %>%
    mutate(variable = outvarname, varplus = outvarname, unit = outunit)
  if(!only.new) {
    return(rbind(fdata, newdata))
  } else {
    return(newdata)
  }
}
```

```{r, echo = FALSE, results = 'hide'}
# Create some total variables that are not directly available in the historical data
sumvars <- c(
    "Emi|BC|Agriculture",
    "Emi|BC|Aircraft",
    "Emi|BC|Energy Sector",
    "Emi|BC|Industrial Sector",
    "Emi|BC|International Shipping",
    "Emi|BC|Residential Commercial Other",
    "Emi|BC|Solvents Production and Application",
    "Emi|BC|Transportation Sector",
    "Emi|BC|Waste"
  )

data <- data %>% 
  filter(model == "CEDS IAMC sectors") %>%
  addSumVariables(sumvars, "Emi|BC", only.new = TRUE) %>%
  bind_rows(data)
```

## BC

### Emi|BC
```{r Black Carbon Emissions - Total}
showLinePlots(data, "Emi|BC", histVars = "Emi|BC", vlines = 2020)
```

### Emi|BC|Energy Demand|Buildings
```{r Black Carbon Emissions - Buildings}
showLinePlots(data, "Emi|BC|Energy Demand|Buildings", histVars = "Emi|BC|Energy|Demand|Buildings", vlines = 2020)
```

### Emi|BC|Energy Demand|Industry
```{r Black Carbon Emissions - Industry}
showLinePlots(data, "Emi|BC|Energy Demand|Industry", histVars = "Emi|BC|Energy|Demand|Industry", vlines = 2020)
```

### Emi|BC|Energy Demand|Transport
```{r Black Carbon Emissions - Transport}
showLinePlots(data, "Emi|BC|Energy Demand|Transport", histVars = "Emi|BC|Energy|Demand|Transport", vlines = 2020)
```

### Emi|BC|Energy Demand|Transport|Aviation
```{r BC Emissions - Total}
showLinePlots(data, "Emi|BC|Energy Demand|Transport|Aviation", histVars = "Emi|BC|Transport|Pass|Aviation|International|Demand", vlines = 2020)
```

### Emi|BC|Energy Demand|Transport|International Shipping
```{r BC Emissions - Total}
showLinePlots(data, "Emi|BC|Energy Demand|Transport|International Shipping", histVars = "Emi|BC|International Shipping", vlines = 2020)
```

### Emi|BC|Energy Supply
```{r Black Carbon Emissions - Energy Supply}
showLinePlots(data, "Emi|BC|Energy Supply", histVars = "Emi|BC|Energy|Supply", vlines = 2020)
```

### Emi|BC|Land Use
```{r Black Carbon Emissions - Land use}
showLinePlots(data, "Emi|BC|Land Use", histVars = "Emissions|BC|Land|", vlines = 2020)
```

### Emi|BC|Solvents
```{r Black Carbon Emissions - Solvents}
showLinePlots(data, "Emi|BC|Solvents", histVars = "Emi|BC|Solvents Production and Application", vlines = 2020)
```

### Emi|BC|Waste
```{r Black Carbon Emissions - Waste}
showLinePlots(data, "Emi|BC|Waste", histVars = "Emi|BC|Waste", vlines = 2020)
```

## SO2 

### Emi|SO2|Energy Supply
```{r SO2 Emissions - Total}
showLinePlots(data, "Emi|SO2|Energy Supply", histVars = "Emi|Sulfur|Energy|Supply", vlines = 2020)
```

### Emi|SO2|Energy Demand|Buildings
```{r SO2 Emissions - Total}
showLinePlots(data, "Emi|SO2|Energy Demand|Buildings", histVars = "Emi|Sulfur|Energy|Demand|Buildings", vlines = 2020)
```

### Emi|SO2|Energy Demand|Industry
```{r SO2 Emissions - Total}
showLinePlots(data, "Emi|SO2|Energy Demand|Industry", histVars = "Emi|Sulfur|Energy|Demand|Industry", vlines = 2020)
```

### Emi|SO2|Energy Demand|Transport
```{r SO2 Emissions - Total}
showLinePlots(data, "Emi|SO2|Energy Demand|Transport", histVars = "Emi|Sulfur|Energy|Demand|Transport", vlines = 2020)
```

### Emi|SO2|Energy Demand|Transport|Aviation
```{r SO2 Emissions - Total}
showLinePlots(data, "Emi|SO2|Energy Demand|Transport|Aviation", histVars = "Emi|Sulfur|Transport|Pass|Aviation|International|Demand", vlines = 2020)
```

### Emi|SO2|Energy Demand|Transport|International Shipping
```{r SO2 Emissions - Total}
showLinePlots(data, "Emi|SO2|Energy Demand|Transport|International Shipping", histVars = "Emi|Sulfur|International Shipping", vlines = 2020)
```

### Emi|SO2|Land Use
```{r SO2 Emissions - Total}
showLinePlots(data, "Emi|SO2|Land Use", histVars = "Emissions|SO2|Land|", vlines = 2020)
```

### Emi|SO2|Solvents
```{r SO2 Emissions - Total}
showLinePlots(data, "Emi|SO2|Solvents", histVars = "Emi|Sulfur|Solvents Production and Application", vlines = 2020)
```

### Emi|SO2|Waste
```{r SO2 Emissions - Total}
showLinePlots(data, "Emi|SO2|Waste", histVars = "Emi|Sulfur|Waste", vlines = 2020)
```

## VOC 

### Emi|VOC|Energy Supply
```{r VOC Emissions - Total}
showLinePlots(data, "Emi|VOC|Energy Supply", histVars = "Emi|VOC|Energy|Supply", vlines = 2020)
```

### Emi|VOC|Energy Demand|Buildings
```{r VOC Emissions - Total}
showLinePlots(data, "Emi|VOC|Energy Demand|Buildings", histVars = "Emi|VOC|Energy|Demand|Buildings", vlines = 2020)
```

### Emi|VOC|Energy Demand|Industry
```{r VOC Emissions - Total}
showLinePlots(data, "Emi|VOC|Energy Demand|Industry", histVars = "Emi|VOC|Energy|Demand|Industry", vlines = 2020)
```

### Emi|VOC|Energy Demand|Transport
```{r VOC Emissions - Total}
showLinePlots(data, "Emi|VOC|Energy Demand|Transport", histVars = "Emi|VOC|Energy|Demand|Transport", vlines = 2020)
```

### Emi|VOC|Energy Demand|Transport|Aviation
```{r VOC Emissions - Total}
showLinePlots(data, "Emi|VOC|Energy Demand|Transport|Aviation", histVars = "Emi|VOC|Transport|Pass|Aviation|International|Demand", vlines = 2020)
```

### Emi|VOC|Energy Demand|Transport|International Shipping
```{r VOC Emissions - Total}
showLinePlots(data, "Emi|VOC|Energy Demand|Transport|International Shipping", histVars = "Emi|VOC|International Shipping", vlines = 2020)
```

### Emi|VOC|Land Use
```{r VOC Emissions - Total}
showLinePlots(data, "Emi|VOC|Land Use", vlines = 2020)
```

### Emi|VOC|Solvents
```{r VOC Emissions - Total}
showLinePlots(data, "Emi|VOC|Solvents", histVars = "Emi|VOC|Solvents Production and Application", vlines = 2020)
```

### Emi|VOC|Waste
```{r VOC Emissions - Total}
showLinePlots(data, "Emi|VOC|Waste", histVars = "Emi|VOC|Waste", vlines = 2020)
```

## OC 

### Emi|OC|Energy Supply
```{r OC Emissions - Total}
showLinePlots(data, "Emi|OC|Energy Supply", histVars = "Emi|OC|Energy|Supply", vlines = 2020)
```

### Emi|OC|Energy Demand|Buildings
```{r OC Emissions - Total}
showLinePlots(data, "Emi|OC|Energy Demand|Buildings", histVars = "Emi|OC|Energy|Demand|Buildings", vlines = 2020)
```

### Emi|OC|Energy Demand|Industry
```{r OC Emissions - Total}
showLinePlots(data, "Emi|OC|Energy Demand|Industry", histVars = "Emi|OC|Energy|Demand|Industry", vlines = 2020)
```

### Emi|OC|Energy Demand|Transport
```{r OC Emissions - Total}
showLinePlots(data, "Emi|OC|Energy Demand|Transport", histVars = "Emi|OC|Energy|Demand|Transport", vlines = 2020)
```

### Emi|OC|Energy Demand|Transport|Aviation
```{r OC Emissions - Total}
showLinePlots(data, "Emi|OC|Energy Demand|Transport|Aviation", histVars = "Emi|OC|Transport|Pass|Aviation|International|Demand", vlines = 2020)
```

### Emi|OC|Energy Demand|Transport|International Shipping
```{r OC Emissions - Total}
showLinePlots(data, "Emi|OC|Energy Demand|Transport|International Shipping", histVars = "Emi|OC|International Shipping", vlines = 2020)
```

### Emi|OC|Land Use
```{r OC Emissions - Total}
showLinePlots(data, "Emi|OC|Land Use", vlines = 2020)
```

### Emi|OC|Solvents
```{r OC Emissions - Total}
showLinePlots(data, "Emi|OC|Solvents", histVars = "Emi|OC|Solvents Production and Application", vlines = 2020)
```

### Emi|OC|Waste
```{r OC Emissions - Total}
showLinePlots(data, "Emi|OC|Waste", histVars = "Emi|OC|Waste", vlines = 2020)
```

## NOX 

### Emi|NOX|Energy Supply
```{r NOX Emissions - Total}
showLinePlots(data, "Emi|NOX|Energy Supply", histVars = "Emi|NOX|Energy|Supply", vlines = 2020)
```

### Emi|NOX|Energy Demand|Buildings
```{r NOX Emissions - Total}
showLinePlots(data, "Emi|NOX|Energy Demand|Buildings", histVars = "Emi|NOX|Energy|Demand|Buildings", vlines = 2020)
```

### Emi|NOX|Energy Demand|Industry
```{r NOX Emissions - Total}
showLinePlots(data, "Emi|NOX|Energy Demand|Industry", histVars = "Emi|NOX|Energy|Demand|Industry", vlines = 2020)
```

### Emi|NOX|Energy Demand|Transport
```{r NOX Emissions - Total}
showLinePlots(data, "Emi|NOX|Energy Demand|Transport", histVars = "Emi|NOX|Energy|Demand|Transport", vlines = 2020)
```

### Emi|NOX|Energy Demand|Transport|Aviation
```{r NOX Emissions - Total}
showLinePlots(data, "Emi|NOX|Energy Demand|Transport|Aviation", histVars = "Emi|NOX|Transport|Pass|Aviation|International|Demand", vlines = 2020)
```

### Emi|NOX|Energy Demand|Transport|International Shipping
```{r NOX Emissions - Total}
showLinePlots(data, "Emi|NOX|Energy Demand|Transport|International Shipping", histVars = "Emi|NOX|International Shipping", vlines = 2020)
```

### Emi|NOX|Land Use
```{r NOX Emissions - Total}
showLinePlots(data, "Emi|NOX|Land Use", vlines = 2020)
```

### Emi|NOX|Solvents
```{r NOX Emissions - Total}
showLinePlots(data, "Emi|NOX|Solvents", histVars = "Emi|NOX|Solvents Production and Application", vlines = 2020)
```

### Emi|NOX|Waste
```{r NOX Emissions - Total}
showLinePlots(data, "Emi|NOX|Waste", histVars = "Emi|NOX|Waste", vlines = 2020)
```

## NH3 

### Emi|NH3|Energy Supply
```{r NH3 Emissions - Total}
showLinePlots(data, "Emi|NH3|Energy Supply", histVars = "Emi|NH3|Energy|Supply", vlines = 2020)
```

### Emi|NH3|Energy Demand|Buildings
```{r NH3 Emissions - Total}
showLinePlots(data, "Emi|NH3|Energy Demand|Buildings", histVars = "Emi|NH3|Energy|Demand|Buildings", vlines = 2020)
```

### Emi|NH3|Energy Demand|Industry
```{r NH3 Emissions - Total}
showLinePlots(data, "Emi|NH3|Energy Demand|Industry", histVars = "Emi|NH3|Energy|Demand|Industry", vlines = 2020)
```

### Emi|NH3|Energy Demand|Transport
```{r NH3 Emissions - Total}
showLinePlots(data, "Emi|NH3|Energy Demand|Transport", histVars = "Emi|NH3|Energy|Demand|Transport", vlines = 2020)
```

### Emi|NH3|Energy Demand|Transport|Aviation
```{r NH3 Emissions - Total}
showLinePlots(data, "Emi|NH3|Energy Demand|Transport|Aviation", histVars = "Emi|NH3|Transport|Pass|Aviation|International|Demand", vlines = 2020)
```

### Emi|NH3|Energy Demand|Transport|International Shipping
```{r NH3 Emissions - Total}
showLinePlots(data, "Emi|NH3|Energy Demand|Transport|International Shipping", histVars = "Emi|NH3|International Shipping", vlines = 2020)
```

### Emi|NH3|Land Use
```{r NH3 Emissions - Total}
showLinePlots(data, "Emi|NH3|Land Use", vlines = 2020)
```

### Emi|NH3|Solvents
```{r NH3 Emissions - Total}
showLinePlots(data, "Emi|NH3|Solvents", histVars = "Emi|NH3|Solvents Production and Application", vlines = 2020)
```

### Emi|NH3|Waste
```{r NH3 Emissions - Total}
showLinePlots(data, "Emi|NH3|Waste", histVars = "Emi|NH3|Waste", vlines = 2020)
```

## CO 

### Emi|CO|Energy Supply
```{r CO Emissions - Total}
showLinePlots(data, "Emi|CO|Energy Supply", histVars = "Emi|CO|Energy|Supply", vlines = 2020)
```

### Emi|CO|Energy Demand|Buildings
```{r CO Emissions - Total}
showLinePlots(data, "Emi|CO|Energy Demand|Buildings", histVars = "Emi|CO|Energy|Demand|Buildings", vlines = 2020)
```

### Emi|CO|Energy Demand|Industry
```{r CO Emissions - Total}
showLinePlots(data, "Emi|CO|Energy Demand|Industry", histVars = "Emi|CO|Energy|Demand|Industry", vlines = 2020)
```

### Emi|CO|Energy Demand|Transport
```{r CO Emissions - Total}
showLinePlots(data, "Emi|CO|Energy Demand|Transport", histVars = "Emi|CO|Energy|Demand|Transport", vlines = 2020)
```

### Emi|CO|Energy Demand|Transport|Aviation
```{r CO Emissions - Total}
showLinePlots(data, "Emi|CO|Energy Demand|Transport|Aviation", histVars = "Emi|CO|Transport|Pass|Aviation|International|Demand", vlines = 2020)
```

### Emi|CO|Energy Demand|Transport|International Shipping
```{r CO Emissions - Total}
showLinePlots(data, "Emi|CO|Energy Demand|Transport|International Shipping", histVars = "Emi|CO|International Shipping", vlines = 2020)
```

### Emi|CO|Land Use
```{r CO Emissions - Total}
showLinePlots(data, "Emi|CO|Land Use", vlines = 2020)
```

### Emi|CO|Solvents
```{r CO Emissions - Total}
showLinePlots(data, "Emi|CO|Solvents", histVars = "Emi|CO|Solvents Production and Application", vlines = 2020)
```

### Emi|CO|Waste
```{r CO Emissions - Total}
showLinePlots(data, "Emi|CO|Waste", histVars = "Emi|CO|Waste", vlines = 2020)
```